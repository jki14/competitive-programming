<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Fox Ciel has <b>n</b> bags, numbered 0 through <b>n</b>-1.
Each bag contains lots of cards, each with a single number written on it.
For each i and j, bag[i] contains exactly count[i][j] cards with number j on them.<br></br>
<br></br>
You are given the ints <b>m</b>, <b>x</b>, <b>a</b>, <b>b</b>, and <b>c</b>.
The values count[i][j] will be generated from these variables using the pseudocode shown below.
(Watch out for integer overflow.)

<pre>
for i = 0 .. n-1:
	for j = 0 .. m-1:
		count[i][j] = x;
		x = ((x * a + b) xor c) modulo 1,000,000,007.
</pre>

All other values count[i][j] not explicitly initialized in the pseudocode are zero.
Hence, each card in each bag contains a number between 0 and <b>m</b>-1, inclusive.<br></br>
<br></br>
According to Fox Ciel, some numbers are good numbers.
You are given this information encoded as the string <b>isGood</b> with 2*<b>m</b>-1 characters.
For each k, the number k is good if and only if <b>isGood</b>[k] is 'Y'.<br></br>
<br></br>
Let i and j (i &lt j) be any two bags.
The value ans[i][j] is defined as the number of ways in which Ciel can select one card from bag i and one card from bag j in such a way that their sum is a good number.<br></br>
<br></br>
Compute all values ans[i][j].
Then, in order to keep the return value small, compute and return the hash of these values.
More precisely, compute and return the bitwise xor of all values (ans[i][j] modulo 1,000,000,007).
</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>BagAndCards</td></tr><tr><td>Method:</td><td>getHash</td></tr><tr><td>Parameters:</td><td>int, int, int, int, int, int, string</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int getHash(int n, int m, int x, int a, int b, int c, string isGood)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>8.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>Pay attention to the unusual time limit.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>n</b> will be between 2 and 500, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>m</b> will be between 2 and 500, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>x</b> will be between 0 and 1,000,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>a</b> will be between 0 and 1,000,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>b</b> will be between 0 and 1,000,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>c</b> will be between 0 and 1,000,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>isGood</b> will contain exactly (2*<b>m</b>-1) elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element in <b>isGood</b> will be 'Y' or 'N'.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>2</pre></td></tr><tr><td><pre>4</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>&quot;NNYYNYN&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 9</pre></td></tr><tr><td><table><tr><td colspan="2">We have two bags.
Each of these bags contains the following cards: {0,1,2,3}.
That is, for each i between 0 and 1 inclusive, and for each j between 0 and 3 inclusive, we have count[i][j] = 1.<br></br>
<br></br>
The good numbers are 2, 3, and 5.
There are 9 ways to get a good number:<br></br>
<pre>
ways to get sum 2: 0+2, 1+1, 2+0
ways to get sum 3: 0+3, 1+2, 2+1, 3+0
ways to get sum 5: 2+3 ,3+2
</pre></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>3</pre></td></tr><tr><td><pre>5</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>2</pre></td></tr><tr><td><pre>&quot;NNYYNYNYN&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1532</pre></td></tr><tr><td><table><tr><td colspan="2">count will be:
<pre>
{{1,0,3,6,5},
 {4,7,10,9,8},
 {11,14,13,12,15}}
</pre>
And the answers will be:
<pre>
ans[0][1] = 291
ans[0][2] = 500
ans[1][2] = 1323
</pre>
So you should return 291^500^1323 = 1532</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>10</pre></td></tr><tr><td><pre>20</pre></td></tr><tr><td><pre>111</pre></td></tr><tr><td><pre>222</pre></td></tr><tr><td><pre>333</pre></td></tr><tr><td><pre>444</pre></td></tr><tr><td><pre>&quot;NNNNNYYYNNNYYYYYYNNYYYYNNNNYNNYYYNNNYYN&quot; </pre></td></tr></table></td></tr><tr><td><pre>Returns: 450750683</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>2</pre></td></tr><tr><td><pre>2</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>&quot;NNY&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
