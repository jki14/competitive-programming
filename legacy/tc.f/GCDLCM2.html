<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>
Some positive integers, not necessarily distinct, are written on a blackboard.
You are given these integers in a format that is specified at the end of this statement.
</p>
<p>
You are allowed to change the numbers on the blackboard in a sequence of steps.
In each step, you have to execute the following actions, in order:
<ol>
<li>Erase x and y. (Erase exactly two numbers. If there are other copies of these numbers on the blackboard, leave them untouched.)</li>
<li>Write two new integers onto the blackboard: gcd(x,y) and lcm(x,y).</li>
</ol>
(Above, gcd(x,y) denotes the greatest common divisor and lcm(x,y) the least common multiple of x and y.)
</p>

<p>
You may perform arbitrarily many steps (possibly even zero).
Your goal is to maximize the sum of numbers written on the blackboard.
Let S be the largest possible sum.
Compute and return the value (S modulo 1,000,000,007).
</p>

<p>
You are given the vector &lt;int&gt;s <b>start</b>, <b>d</b>, and <b>cnt</b>, each with the same number of elements.
Use the following pseudocode to generate the numbers on the blackboard:
</p>

<pre>
L = length(start)
for i = 0 .. L-1:
    for j = 0 .. cnt[i]-1:
        write the number (start[i] + j * d[i]) onto the blackboard
</pre></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>GCDLCM2</td></tr><tr><td>Method:</td><td>getMaximalSum</td></tr><tr><td>Parameters:</td><td>vector &lt;int&gt;, vector &lt;int&gt;, vector &lt;int&gt;</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int getMaximalSum(vector &lt;int&gt; start, vector &lt;int&gt; d, vector &lt;int&gt; cnt)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>Note that you are maximizing the sum S. You are <i>not</i> maximizing the return value.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>start</b>, <b>d</b> and <b>cnt</b> will have the same number of elements.</td></tr><tr><td align="center" valign="top">-</td><td><b>start</b> will contain between 1 and 500 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>start</b> and <b>cnt</b> will be between 1 and 10,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>d</b> will be between 0 and 10,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>For each valid i, <b>start</b>[i] + <b>d</b>[i] * (<b>cnt</b>[i] - 1) will be at most 10,000,000.</td></tr><tr><td align="center" valign="top">-</td><td>The sum of all <b>cnt</b>[i] will be between 1 and 100,000, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1}</pre></td></tr><tr><td><pre>{1}</pre></td></tr><tr><td><pre>{3}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 8</pre></td></tr><tr><td><table><tr><td colspan="2"> 

<p>
There are three numbers on the blackboard: 1, 2 and 3. You can replace numbers 2 and 3 with numbers 1 and 6.
</p>
<p>
Then sum is 1 + 1 + 6 = 8 (which can be proved to be maximal). The answer is (8 modulo 1,000,000,007) = 8.
</p></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{3}</pre></td></tr><tr><td><pre>{0}</pre></td></tr><tr><td><pre>{5}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 15</pre></td></tr><tr><td><table><tr><td colspan="2">There are five numbers 3 on the blackboard. It's impossible to perform even a single operation so the maximal sum is 15. </td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{2}</pre></td></tr><tr><td><pre>{2}</pre></td></tr><tr><td><pre>{4}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 32</pre></td></tr><tr><td><table><tr><td colspan="2">Numbers on the blackboard are 2, 4, 6, 8.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1, 2}</pre></td></tr><tr><td><pre>{2, 3}</pre></td></tr><tr><td><pre>{2, 2}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 33</pre></td></tr><tr><td><table><tr><td colspan="2">Numbers on the blackboard are 1, 3, 2, 5.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{5 ,6}</pre></td></tr><tr><td><pre>{23, 45}</pre></td></tr><tr><td><pre>{50000, 50000}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 804225394</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
